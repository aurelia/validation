{"version":3,"file":"aurelia-validation.js","sources":["../../src/validator.ts","../../src/validate-result.ts","../../src/implementation/rules.ts","../../src/implementation/expression-visitor.ts","../../src/implementation/validation-message-parser.ts","../../src/implementation/validation-messages.ts","../../src/implementation/standard-validator.ts","../../src/validate-trigger.ts","../../src/config.ts","../../src/get-target-dom-element.ts","../../src/property-info.ts","../../src/util.ts","../../src/property-accessor-parser.ts","../../src/validate-event.ts","../../src/validation-controller.ts","../../src/validate-binding-behavior-base.ts","../../src/validate-binding-behavior.ts","../../src/validation-controller-factory.ts","../../src/validation-errors-custom-attribute.ts","../../src/validation-renderer-custom-attribute.ts","../../src/implementation/validation-rules.ts","../../src/aurelia-validation.ts"],"sourcesContent":["import { ValidateResult } from './validate-result';\r\n\r\n/**\r\n * Validates objects and properties.\r\n */\r\nexport abstract class Validator {\r\n  /**\r\n   * Validates the specified property.\r\n   * @param object The object to validate.\r\n   * @param propertyName The name of the property to validate.\r\n   * @param rules Optional. If unspecified, the implementation should lookup the rules for the\r\n   * specified object. This may not be possible for all implementations of this interface.\r\n   */\r\n  public abstract validateProperty(object: any, propertyName: string, rules?: any): Promise<ValidateResult[]>;\r\n\r\n  /**\r\n   * Validates all rules for specified object and it's properties.\r\n   * @param object The object to validate.\r\n   * @param rules Optional. If unspecified, the implementation should lookup the rules for the\r\n   * specified object. This may not be possible for all implementations of this interface.\r\n   */\r\n  public abstract validateObject(object: any, rules?: any): Promise<ValidateResult[]>;\r\n\r\n  /**\r\n   * Determines whether a rule exists in a set of rules.\r\n   * @param rules The rules to search.\r\n   * @parem rule The rule to find.\r\n   */\r\n  public abstract ruleExists(rules: any, rule: any): boolean;\r\n}\r\n","/**\r\n * The result of validating an individual validation rule.\r\n */\r\nexport class ValidateResult {\r\n  private static nextId = 0;\r\n\r\n  /**\r\n   * A number that uniquely identifies the result instance.\r\n   */\r\n  public id: number;\r\n\r\n  /**\r\n   * @param rule The rule associated with the result. Validator implementation specific.\r\n   * @param object The object that was validated.\r\n   * @param propertyName The name of the property that was validated.\r\n   * @param error The error, if the result is a validation error.\r\n   */\r\n  constructor(\r\n    public rule: any,\r\n    public object: any,\r\n    public propertyName: string | number | null,\r\n    public valid: boolean,\r\n    public message: string | null = null\r\n  ) {\r\n    this.id = ValidateResult.nextId++;\r\n  }\r\n\r\n  public toString() {\r\n    return this.valid ? 'Valid.' : this.message;\r\n  }\r\n}\r\n","import { Rule } from './rule';\r\n\r\n/**\r\n * Sets, unsets and retrieves rules on an object or constructor function.\r\n */\r\nexport class Rules {\r\n  /**\r\n   * The name of the property that stores the rules.\r\n   */\r\n  private static key = '__rules__';\r\n\r\n  /**\r\n   * Applies the rules to a target.\r\n   */\r\n  public static set(target: any, rules: Rule<any, any>[][]): void {\r\n    if (target instanceof Function) {\r\n      target = target.prototype;\r\n    }\r\n    Object.defineProperty(\r\n      target,\r\n      Rules.key,\r\n      { enumerable: false, configurable: false, writable: true, value: rules });\r\n  }\r\n\r\n  /**\r\n   * Removes rules from a target.\r\n   */\r\n  public static unset(target: any): void {\r\n    if (target instanceof Function) {\r\n      target = target.prototype;\r\n    }\r\n    target[Rules.key] = null;\r\n  }\r\n\r\n  /**\r\n   * Retrieves the target's rules.\r\n   */\r\n  public static get(target: any): Rule<any, any>[][] | null {\r\n    return target[Rules.key] || null;\r\n  }\r\n}\r\n","import {\r\n  Expression,\r\n  ValueConverter,\r\n  Conditional,\r\n  AccessScope,\r\n  AccessMember,\r\n  AccessKeyed,\r\n  CallMember,\r\n  BindingBehavior,\r\n  Binary,\r\n  LiteralPrimitive,\r\n  LiteralString\r\n} from 'aurelia-binding';\r\n\r\n// tslint:disable:no-empty\r\nexport class ExpressionVisitor {\r\n  public visitChain(chain: any) {\r\n    this.visitArgs(chain.expressions);\r\n  }\r\n\r\n  public visitBindingBehavior(behavior: BindingBehavior) {\r\n    behavior.expression.accept(this);\r\n    this.visitArgs(behavior.args);\r\n  }\r\n\r\n  public visitValueConverter(converter: ValueConverter) {\r\n    converter.expression.accept(this);\r\n    this.visitArgs(converter.args);\r\n  }\r\n\r\n  public visitAssign(assign: any) {\r\n    assign.target.accept(this);\r\n    assign.value.accept(this);\r\n  }\r\n\r\n  public visitConditional(conditional: Conditional) {\r\n    conditional.condition.accept(this);\r\n    conditional.yes.accept(this);\r\n    conditional.no.accept(this);\r\n  }\r\n\r\n  public visitAccessThis(access: any) {\r\n    access.ancestor = access.ancestor;\r\n  }\r\n\r\n  public visitAccessScope(access: AccessScope) {\r\n    access.name = access.name;\r\n  }\r\n\r\n  public visitAccessMember(access: AccessMember) {\r\n    access.object.accept(this);\r\n  }\r\n\r\n  public visitAccessKeyed(access: AccessKeyed) {\r\n    access.object.accept(this);\r\n    access.key.accept(this);\r\n  }\r\n\r\n  public visitCallScope(call: any) {\r\n    this.visitArgs(call.args);\r\n  }\r\n\r\n  public visitCallFunction(call: any) {\r\n    call.func.accept(this);\r\n    this.visitArgs(call.args);\r\n  }\r\n\r\n  public visitCallMember(call: CallMember) {\r\n    call.object.accept(this);\r\n    this.visitArgs(call.args);\r\n  }\r\n\r\n  public visitPrefix(prefix: any) {\r\n    prefix.expression.accept(this);\r\n  }\r\n\r\n  public visitBinary(binary: Binary) {\r\n    binary.left.accept(this);\r\n    binary.right.accept(this);\r\n  }\r\n\r\n  public visitLiteralPrimitive(literal: LiteralPrimitive) {\r\n    literal.value = literal.value;\r\n  }\r\n\r\n  public visitLiteralArray(literal: any) {\r\n    this.visitArgs(literal.elements);\r\n  }\r\n\r\n  public visitLiteralObject(literal: any) {\r\n    this.visitArgs(literal.values);\r\n  }\r\n\r\n  public visitLiteralString(literal: LiteralString) {\r\n    literal.value = literal.value;\r\n  }\r\n\r\n  private visitArgs(args: Expression[]) {\r\n    for (let i = 0; i < args.length; i++) {\r\n      args[i].accept(this);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Expression,\r\n  AccessScope,\r\n  LiteralString,\r\n  Binary,\r\n  Conditional,\r\n  LiteralPrimitive,\r\n  CallMember\r\n} from 'aurelia-binding';\r\nimport { BindingLanguage } from 'aurelia-templating';\r\nimport * as LogManager from 'aurelia-logging';\r\nimport { ExpressionVisitor } from './expression-visitor';\r\n\r\nexport class ValidationMessageParser {\r\n  public static inject = [BindingLanguage];\r\n\r\n  private emptyStringExpression = new LiteralString('');\r\n  private nullExpression = new LiteralPrimitive(null);\r\n  private undefinedExpression = new LiteralPrimitive(undefined);\r\n  private cache: { [message: string]: Expression } = {};\r\n\r\n  constructor(private bindinqLanguage: BindingLanguage) { }\r\n\r\n  public parse(message: string): Expression {\r\n    if (this.cache[message] !== undefined) {\r\n      return this.cache[message];\r\n    }\r\n\r\n    const parts: (Expression | string)[] | null = (this.bindinqLanguage as any).parseInterpolation(null, message);\r\n    if (parts === null) {\r\n      return new LiteralString(message);\r\n    }\r\n    let expression: Expression = new LiteralString(parts[0] as string);\r\n    for (let i = 1; i < parts.length; i += 2) {\r\n      expression = new Binary(\r\n        '+',\r\n        expression,\r\n        new Binary(\r\n          '+',\r\n          this.coalesce(parts[i] as Expression),\r\n          new LiteralString(parts[i + 1] as string)\r\n        )\r\n      );\r\n    }\r\n\r\n    MessageExpressionValidator.validate(expression, message);\r\n\r\n    this.cache[message] = expression;\r\n\r\n    return expression;\r\n  }\r\n\r\n  private coalesce(part: Expression): Expression {\r\n    // part === null || part === undefined ? '' : part\r\n    return new Conditional(\r\n      new Binary(\r\n        '||',\r\n        new Binary('===', part, this.nullExpression),\r\n        new Binary('===', part, this.undefinedExpression)\r\n      ),\r\n      this.emptyStringExpression,\r\n      new CallMember(part, 'toString', [])\r\n    );\r\n  }\r\n}\r\n\r\nexport class MessageExpressionValidator extends ExpressionVisitor {\r\n  public static validate(expression: Expression, originalMessage: string) {\r\n    const visitor = new MessageExpressionValidator(originalMessage);\r\n    expression.accept(visitor);\r\n  }\r\n\r\n  constructor(private originalMessage: string) {\r\n    super();\r\n  }\r\n\r\n  public visitAccessScope(access: AccessScope) {\r\n    if (access.ancestor !== 0) {\r\n      throw new Error('$parent is not permitted in validation message expressions.');\r\n    }\r\n    if (['displayName', 'propertyName', 'value', 'object', 'config', 'getDisplayName'].indexOf(access.name) !== -1) {\r\n      LogManager.getLogger('aurelia-validation')\r\n        // tslint:disable-next-line:max-line-length\r\n        .warn(`Did you mean to use \"$${access.name}\" instead of \"${access.name}\" in this validation message template: \"${this.originalMessage}\"?`);\r\n    }\r\n  }\r\n}\r\n","import { Expression } from 'aurelia-binding';\r\nimport { ValidationMessageParser } from './validation-message-parser';\r\n\r\nexport interface ValidationMessages {\r\n  [key: string]: string;\r\n}\r\n\r\n/**\r\n * Dictionary of validation messages. [messageKey]: messageExpression\r\n */\r\nexport const validationMessages: ValidationMessages = {\r\n  /**\r\n   * The default validation message. Used with rules that have no standard message.\r\n   */\r\n  default: `\\${$displayName} is invalid.`,\r\n  required: `\\${$displayName} is required.`,\r\n  matches: `\\${$displayName} is not correctly formatted.`,\r\n  email: `\\${$displayName} is not a valid email.`,\r\n  minLength: `\\${$displayName} must be at least \\${$config.length} character\\${$config.length === 1 ? '' : 's'}.`,\r\n  maxLength: `\\${$displayName} cannot be longer than \\${$config.length} character\\${$config.length === 1 ? '' : 's'}.`,\r\n  minItems: `\\${$displayName} must contain at least \\${$config.count} item\\${$config.count === 1 ? '' : 's'}.`,\r\n  maxItems: `\\${$displayName} cannot contain more than \\${$config.count} item\\${$config.count === 1 ? '' : 's'}.`,\r\n  min: `\\${$displayName} must be at least \\${$config.constraint}.`,\r\n  max: `\\${$displayName} must be at most \\${$config.constraint}.`,\r\n  range: `\\${$displayName} must be between or equal to \\${$config.min} and \\${$config.max}.`,\r\n  between: `\\${$displayName} must be between but not equal to \\${$config.min} and \\${$config.max}.`,\r\n  equals: `\\${$displayName} must be \\${$config.expectedValue}.`,\r\n};\r\n\r\n/**\r\n * Retrieves validation messages and property display names.\r\n */\r\nexport class ValidationMessageProvider {\r\n  public static inject = [ValidationMessageParser];\r\n\r\n  constructor(public parser: ValidationMessageParser) { }\r\n\r\n  /**\r\n   * Returns a message binding expression that corresponds to the key.\r\n   * @param key The message key.\r\n   */\r\n  public getMessage(key: string): Expression {\r\n    let message: string;\r\n    if (key in validationMessages) {\r\n      message = validationMessages[key];\r\n    } else {\r\n      message = validationMessages['default'];\r\n    }\r\n    return this.parser.parse(message);\r\n  }\r\n\r\n  /**\r\n   * Formulates a property display name using the property name and the configured\r\n   * displayName (if provided).\r\n   * Override this with your own custom logic.\r\n   * @param propertyName The property name.\r\n   */\r\n  public getDisplayName(propertyName: string | number, displayName?: string | null | (() => string)): string {\r\n    if (displayName !== null && displayName !== undefined) {\r\n      return (displayName instanceof Function) ? displayName() : displayName as string;\r\n    }\r\n\r\n    // split on upper-case letters.\r\n    const words = propertyName.toString().split(/(?=[A-Z])/).join(' ');\r\n    // capitalize first letter.\r\n    return words.charAt(0).toUpperCase() + words.slice(1);\r\n  }\r\n}\r\n","import { Expression, LookupFunctions } from 'aurelia-binding';\r\nimport { ViewResources } from 'aurelia-templating';\r\nimport { Validator } from '../validator';\r\nimport { ValidateResult } from '../validate-result';\r\nimport { Rule } from './rule';\r\nimport { Rules } from './rules';\r\nimport { ValidationMessageProvider } from './validation-messages';\r\n\r\n/**\r\n * Validates.\r\n * Responsible for validating objects and properties.\r\n */\r\nexport class StandardValidator extends Validator {\r\n  public static inject = [ValidationMessageProvider, ViewResources];\r\n\r\n  private messageProvider: ValidationMessageProvider;\r\n  private lookupFunctions: LookupFunctions;\r\n  private getDisplayName: (propertyName: string) => string;\r\n\r\n  constructor(messageProvider: ValidationMessageProvider, resources: ViewResources) {\r\n    super();\r\n    this.messageProvider = messageProvider;\r\n    this.lookupFunctions = (resources as any).lookupFunctions;\r\n    this.getDisplayName = messageProvider.getDisplayName.bind(messageProvider);\r\n  }\r\n\r\n  /**\r\n   * Validates the specified property.\r\n   * @param object The object to validate.\r\n   * @param propertyName The name of the property to validate.\r\n   * @param rules Optional. If unspecified, the rules will be looked up using the metadata\r\n   * for the object created by ValidationRules....on(class/object)\r\n   */\r\n  public validateProperty(object: any, propertyName: string | number, rules?: any): Promise<ValidateResult[]> {\r\n    return this.validate(object, propertyName, rules || null);\r\n  }\r\n\r\n  /**\r\n   * Validates all rules for specified object and it's properties.\r\n   * @param object The object to validate.\r\n   * @param rules Optional. If unspecified, the rules will be looked up using the metadata\r\n   * for the object created by ValidationRules....on(class/object)\r\n   */\r\n  public validateObject(object: any, rules?: any): Promise<ValidateResult[]> {\r\n    return this.validate(object, null, rules || null);\r\n  }\r\n\r\n  /**\r\n   * Determines whether a rule exists in a set of rules.\r\n   * @param rules The rules to search.\r\n   * @parem rule The rule to find.\r\n   */\r\n  public ruleExists(rules: Rule<any, any>[][], rule: Rule<any, any>): boolean {\r\n    let i = rules.length;\r\n    while (i--) {\r\n      if (rules[i].indexOf(rule) !== -1) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private getMessage(rule: Rule<any, any>, object: any, value: any): string {\r\n    const expression: Expression = rule.message || this.messageProvider.getMessage(rule.messageKey);\r\n    // tslint:disable-next-line:prefer-const\r\n    let { name: propertyName, displayName } = rule.property;\r\n    if (propertyName !== null) {\r\n      displayName = this.messageProvider.getDisplayName(propertyName, displayName);\r\n    }\r\n    const overrideContext: any = {\r\n      $displayName: displayName,\r\n      $propertyName: propertyName,\r\n      $value: value,\r\n      $object: object,\r\n      $config: rule.config,\r\n      // returns the name of a given property, given just the property name (irrespective of the property's displayName)\r\n      // split on capital letters, first letter ensured to be capitalized\r\n      $getDisplayName: this.getDisplayName\r\n    };\r\n    return expression.evaluate(\r\n      { bindingContext: object, overrideContext },\r\n      this.lookupFunctions);\r\n  }\r\n\r\n  private validateRuleSequence(\r\n    object: any,\r\n    propertyName: string | number | null,\r\n    ruleSequence: Rule<any, any>[][],\r\n    sequence: number,\r\n    results: ValidateResult[]\r\n  ): Promise<ValidateResult[]> {\r\n    // are we validating all properties or a single property?\r\n    const validateAllProperties = propertyName === null || propertyName === undefined;\r\n\r\n    const rules = ruleSequence[sequence];\r\n    let allValid = true;\r\n\r\n    // validate each rule.\r\n    const promises: Promise<boolean>[] = [];\r\n    for (let i = 0; i < rules.length; i++) {\r\n      const rule = rules[i];\r\n\r\n      // is the rule related to the property we're validating.\r\n      // tslint:disable-next-line:triple-equals | Use loose equality for property keys\r\n      if (!validateAllProperties && rule.property.name != propertyName) {\r\n        continue;\r\n      }\r\n\r\n      // is this a conditional rule? is the condition met?\r\n      if (rule.when && !rule.when(object)) {\r\n        continue;\r\n      }\r\n\r\n      // validate.\r\n      const value = rule.property.name === null ? object : object[rule.property.name];\r\n      let promiseOrBoolean = rule.condition(value, object);\r\n      if (!(promiseOrBoolean instanceof Promise)) {\r\n        promiseOrBoolean = Promise.resolve(promiseOrBoolean);\r\n      }\r\n      promises.push(promiseOrBoolean.then(valid => {\r\n          const message = valid ? null : this.getMessage(rule, object, value);\r\n          results.push(new ValidateResult(rule, object, rule.property.name, valid, message));\r\n          allValid = allValid && valid;\r\n          return valid;\r\n        }));\r\n    }\r\n\r\n    return Promise.all(promises)\r\n      .then(() => {\r\n      sequence++;\r\n      if (allValid && sequence < ruleSequence.length) {\r\n        return this.validateRuleSequence(object, propertyName, ruleSequence, sequence, results);\r\n      }\r\n      return results;\r\n    });\r\n  }\r\n\r\n  private validate(\r\n    object: any,\r\n    propertyName: string | number | null,\r\n    rules: Rule<any, any>[][] | null\r\n  ): Promise<ValidateResult[]> {\r\n    // rules specified?\r\n    if (!rules) {\r\n      // no. attempt to locate the rules.\r\n      rules = Rules.get(object);\r\n    }\r\n\r\n    // any rules?\r\n    if (!rules || rules.length === 0) {\r\n      return Promise.resolve([]);\r\n    }\r\n\r\n    return this.validateRuleSequence(object, propertyName, rules, 0, []);\r\n  }\r\n}\r\n","/**\r\n * Validation triggers.\r\n */\r\nexport enum validateTrigger {\r\n  /**\r\n   * Manual validation.  Use the controller's `validate()` and  `reset()` methods\r\n   * to validate all bindings.\r\n   */\r\n  manual = 0,           // 0x000\r\n\r\n  /**\r\n   * Validate the binding when the binding's target element fires a DOM \"blur\" event.\r\n   */\r\n  blur = 1,             // 0x001\r\n\r\n  /**\r\n   * Validate the binding when it updates the model due to a change in the view.\r\n   */\r\n  change = 2,           // 0x010\r\n\r\n  /**\r\n   * Validate the binding when the binding's target element fires a DOM \"blur\" event and\r\n   * when it updates the model due to a change in the view.\r\n   */\r\n  changeOrBlur = 3,     // 0x011\r\n\r\n  /**\r\n   * Validate the binding when the binding's target element fires a DOM \"focusout\" event.\r\n   * Unlike \"blur\", this event bubbles.\r\n   */\r\n  focusout = 4,         // 0x100\r\n\r\n  /**\r\n   * Validate the binding when the binding's target element fires a DOM \"focusout\" event or\r\n   * when it updates the model due to a change in the view.\r\n   */\r\n  changeOrFocusout = 6, // 0x110\r\n}\r\n","import { Container } from 'aurelia-dependency-injection';\r\nimport { Validator } from './validator';\r\nimport { StandardValidator } from './implementation/standard-validator';\r\nimport { validateTrigger } from './validate-trigger';\r\n\r\nexport type ValidatorCtor = new (...args: any[]) => Validator;\r\n\r\n/**\r\n * Aurelia Validation Configuration API\r\n */\r\nexport class GlobalValidationConfiguration {\r\n  public static DEFAULT_VALIDATION_TRIGGER = validateTrigger.blur;\r\n\r\n  private validatorType: ValidatorCtor = StandardValidator;\r\n  private validationTrigger = GlobalValidationConfiguration.DEFAULT_VALIDATION_TRIGGER;\r\n\r\n  /**\r\n   * Use a custom Validator implementation.\r\n   */\r\n  public customValidator(type: ValidatorCtor) {\r\n    this.validatorType = type;\r\n    return this;\r\n  }\r\n\r\n  public defaultValidationTrigger(trigger: validateTrigger) {\r\n    this.validationTrigger = trigger;\r\n    return this;\r\n  }\r\n\r\n  public getDefaultValidationTrigger() {\r\n    return this.validationTrigger;\r\n  }\r\n\r\n  /**\r\n   * Applies the configuration.\r\n   */\r\n  public apply(container: Container) {\r\n    const validator = container.get(this.validatorType);\r\n    container.registerInstance(Validator, validator);\r\n    container.registerInstance(GlobalValidationConfiguration, this);\r\n  }\r\n}\r\n","import { DOM } from 'aurelia-pal';\r\n\r\n/**\r\n * Gets the DOM element associated with the data-binding. Most of the time it's\r\n * the binding.target but sometimes binding.target is an aurelia custom element,\r\n * or custom attribute which is a javascript \"class\" instance, so we need to use\r\n * the controller's container to retrieve the actual DOM element.\r\n */\r\nexport function getTargetDOMElement(binding: any, view: any): Element {\r\n  const target = binding.target;\r\n  // DOM element\r\n  if (target instanceof Element) {\r\n    return target;\r\n  }\r\n  // custom element or custom attribute\r\n  // tslint:disable-next-line:prefer-const\r\n  for (let i = 0, ii = view.controllers.length; i < ii; i++) {\r\n    const controller: any = view.controllers[i];\r\n    if (controller.viewModel === target) {\r\n      const element = controller.container.get(DOM.Element);\r\n      if (element) {\r\n        return element;\r\n      }\r\n      throw new Error(`Unable to locate target element for \"${binding.sourceExpression}\".`);\r\n    }\r\n  }\r\n  throw new Error(`Unable to locate target element for \"${binding.sourceExpression}\".`);\r\n}\r\n","import {\r\n  AccessMember,\r\n  AccessScope,\r\n  AccessKeyed,\r\n  BindingBehavior,\r\n  Expression,\r\n  ValueConverter,\r\n  Scope,\r\n  getContextFor\r\n} from 'aurelia-binding';\r\n\r\nfunction getObject(expression: Expression, objectExpression: Expression, source: any): null | undefined | object {\r\n  const value = objectExpression.evaluate(source, null as any);\r\n  if (value === null || value === undefined || value instanceof Object) {\r\n    return value;\r\n  }\r\n  // tslint:disable-next-line:max-line-length\r\n  throw new Error(`The '${objectExpression}' part of '${expression}' evaluates to ${value} instead of an object, null or undefined.`);\r\n}\r\n\r\n/**\r\n * Retrieves the object and property name for the specified expression.\r\n * @param expression The expression\r\n * @param source The scope\r\n */\r\nexport function getPropertyInfo(\r\n  expression: Expression,\r\n  source: Scope\r\n): { object: object; propertyName: string; } | null {\r\n  const originalExpression = expression;\r\n  while (expression instanceof BindingBehavior || expression instanceof ValueConverter) {\r\n    expression = expression.expression;\r\n  }\r\n\r\n  let object: null | undefined | object;\r\n  let propertyName: string;\r\n  if (expression instanceof AccessScope) {\r\n    object = getContextFor(expression.name, source, expression.ancestor);\r\n    propertyName = expression.name;\r\n  } else if (expression instanceof AccessMember) {\r\n    object = getObject(originalExpression, expression.object, source);\r\n    propertyName = expression.name;\r\n  } else if (expression instanceof AccessKeyed) {\r\n    object = getObject(originalExpression, expression.object, source);\r\n    propertyName = expression.key.evaluate(source);\r\n  } else {\r\n    throw new Error(`Expression '${originalExpression}' is not compatible with the validate binding-behavior.`);\r\n  }\r\n  if (object === null || object === undefined) {\r\n    return null;\r\n  }\r\n  return { object, propertyName };\r\n}\r\n","export function isString(value: any): boolean {\r\n  return Object.prototype.toString.call(value) === '[object String]';\r\n}\r\n\r\nexport function isNumber(value: any): boolean {\r\n  return Object.prototype.toString.call(value) === '[object Number]';\r\n}\r\n","import {\r\n  Parser,\r\n  AccessMember,\r\n  AccessScope\r\n} from 'aurelia-binding';\r\nimport { isString, isNumber } from './util';\r\n\r\nexport type PropertyAccessor<TObject, TValue> = (object: TObject) => TValue;\r\n\r\nexport class PropertyAccessorParser {\r\n  public static inject = [Parser];\r\n\r\n  constructor(private parser: Parser) { }\r\n\r\n  public parse<TObject, TValue>(property: string | number | PropertyAccessor<TObject, TValue>): string | number {\r\n    if (isString(property) || isNumber(property)) {\r\n      return property as string | number;\r\n    }\r\n    const accessorText = getAccessorExpression(property.toString());\r\n    const accessor = this.parser.parse(accessorText);\r\n    if (accessor instanceof AccessScope\r\n      || accessor instanceof AccessMember && accessor.object instanceof AccessScope) {\r\n      return accessor.name;\r\n    }\r\n    throw new Error(`Invalid property expression: \"${accessor}\"`);\r\n  }\r\n}\r\n\r\nexport function getAccessorExpression(fn: string): string {\r\n  /* tslint:disable:max-line-length */\r\n  const classic = /^function\\s*\\([$_\\w\\d]+\\)\\s*\\{(?:\\s*\"use strict\";)?(?:[$_\\s\\w\\d\\/\\*.['\"\\]+;\\(\\)]+)?\\s*return\\s+[$_\\w\\d]+\\.([$_\\w\\d]+)\\s*;?\\s*\\}$/;\r\n  /* tslint:enable:max-line-length */\r\n  const arrow = /^\\(?[$_\\w\\d]+\\)?\\s*=>\\s*[$_\\w\\d]+\\.([$_\\w\\d]+)$/;\r\n  const match = classic.exec(fn) || arrow.exec(fn);\r\n  if (match === null) {\r\n    throw new Error(`Unable to parse accessor function:\\n${fn}`);\r\n  }\r\n  return match[1];\r\n}\r\n","import { ValidateResult } from './validate-result';\r\nimport { ValidateInstruction } from './validate-instruction';\r\nimport { ControllerValidateResult } from './controller-validate-result';\r\n\r\nexport class ValidateEvent {\r\n  constructor(\r\n    /**\r\n     * The type of validate event. Either \"validate\" or \"reset\".\r\n     */\r\n    public readonly type: 'validate' | 'reset',\r\n\r\n    /**\r\n     * The controller's current array of errors. For an array containing both\r\n     * failed rules and passed rules, use the \"results\" property.\r\n     */\r\n    public readonly errors: ValidateResult[],\r\n\r\n    /**\r\n     * The controller's current array of validate results. This\r\n     * includes both passed rules and failed rules. For an array of only failed rules,\r\n     * use the \"errors\" property.\r\n     */\r\n    public readonly results: ValidateResult[],\r\n\r\n    /**\r\n     * The instruction passed to the \"validate\" or \"reset\" event. Will be null when\r\n     * the controller's validate/reset method was called with no instruction argument.\r\n     */\r\n    public readonly instruction: ValidateInstruction | null,\r\n\r\n    /**\r\n     * In events with type === \"validate\", this property will contain the result\r\n     * of validating the instruction (see \"instruction\" property). Use the controllerValidateResult\r\n     * to access the validate results specific to the call to \"validate\"\r\n     * (as opposed to using the \"results\" and \"errors\" properties to access the controller's entire\r\n     * set of results/errors).\r\n     */\r\n    public readonly controllerValidateResult: ControllerValidateResult | null\r\n\r\n  ) { }\r\n}\r\n","import { Binding, Expression } from 'aurelia-binding';\r\nimport { GlobalValidationConfiguration } from './config';\r\nimport { Validator } from './validator';\r\nimport { validateTrigger } from './validate-trigger';\r\nimport { getPropertyInfo } from './property-info';\r\nimport { ValidationRenderer, RenderInstruction } from './validation-renderer';\r\nimport { ValidateResult } from './validate-result';\r\nimport { ValidateInstruction } from './validate-instruction';\r\nimport { ControllerValidateResult } from './controller-validate-result';\r\nimport { PropertyAccessorParser, PropertyAccessor } from './property-accessor-parser';\r\nimport { ValidateEvent } from './validate-event';\r\n\r\n/**\r\n * Orchestrates validation.\r\n * Manages a set of bindings, renderers and objects.\r\n * Exposes the current list of validation results for binding purposes.\r\n */\r\nexport class ValidationController {\r\n  public static inject = [Validator, PropertyAccessorParser, GlobalValidationConfiguration];\r\n\r\n  // Registered bindings (via the validate binding behavior)\r\n  private bindings = new Map<Binding, BindingInfo>();\r\n\r\n  // Renderers that have been added to the controller instance.\r\n  private renderers: ValidationRenderer[] = [];\r\n\r\n  /**\r\n   * Validation results that have been rendered by the controller.\r\n   */\r\n  private results: ValidateResult[] = [];\r\n\r\n  /**\r\n   * Validation errors that have been rendered by the controller.\r\n   */\r\n  public errors: ValidateResult[] = [];\r\n\r\n  /**\r\n   *  Whether the controller is currently validating.\r\n   */\r\n  public validating = false;\r\n\r\n  // Elements related to validation results that have been rendered.\r\n  private elements = new Map<ValidateResult, Element[]>();\r\n\r\n  // Objects that have been added to the controller instance (entity-style validation).\r\n  private objects = new Map<any, any>();\r\n\r\n  /**\r\n   * The trigger that will invoke automatic validation of a property used in a binding.\r\n   */\r\n  public validateTrigger: validateTrigger;\r\n\r\n  // Promise that resolves when validation has completed.\r\n  private finishValidating: Promise<any> = Promise.resolve();\r\n\r\n  private eventCallbacks: ((event: ValidateEvent) => void)[] = [];\r\n\r\n  constructor(\r\n    private validator: Validator,\r\n    private propertyParser: PropertyAccessorParser,\r\n    config?: GlobalValidationConfiguration,\r\n  ) {\r\n    this.validateTrigger = config instanceof GlobalValidationConfiguration\r\n        ? config.getDefaultValidationTrigger()\r\n        : GlobalValidationConfiguration.DEFAULT_VALIDATION_TRIGGER;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to controller validate and reset events. These events occur when the\r\n   * controller's \"validate\"\" and \"reset\" methods are called.\r\n   * @param callback The callback to be invoked when the controller validates or resets.\r\n   */\r\n  public subscribe(callback: (event: ValidateEvent) => void) {\r\n    this.eventCallbacks.push(callback);\r\n    return {\r\n      dispose: () => {\r\n        const index = this.eventCallbacks.indexOf(callback);\r\n        if (index === -1) {\r\n          return;\r\n        }\r\n        this.eventCallbacks.splice(index, 1);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds an object to the set of objects that should be validated when validate is called.\r\n   * @param object The object.\r\n   * @param rules Optional. The rules. If rules aren't supplied the Validator implementation will lookup the rules.\r\n   */\r\n  public addObject(object: any, rules?: any): void {\r\n    this.objects.set(object, rules);\r\n  }\r\n\r\n  /**\r\n   * Removes an object from the set of objects that should be validated when validate is called.\r\n   * @param object The object.\r\n   */\r\n  public removeObject(object: any): void {\r\n    this.objects.delete(object);\r\n    this.processResultDelta(\r\n      'reset',\r\n      this.results.filter(result => result.object === object),\r\n      []);\r\n  }\r\n\r\n  /**\r\n   * Adds and renders an error.\r\n   */\r\n  public addError<TObject>(\r\n    message: string,\r\n    object: TObject,\r\n    propertyName: string | PropertyAccessor<TObject, string> | null = null\r\n  ): ValidateResult {\r\n    let resolvedPropertyName: string | number | null;\r\n    if (propertyName === null) {\r\n      resolvedPropertyName = propertyName as any;\r\n    } else {\r\n      resolvedPropertyName = this.propertyParser.parse(propertyName);\r\n    }\r\n    const result = new ValidateResult({ __manuallyAdded__: true }, object, resolvedPropertyName, false, message);\r\n    this.processResultDelta('validate', [], [result]);\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Removes and unrenders an error.\r\n   */\r\n  public removeError(result: ValidateResult) {\r\n    if (this.results.indexOf(result) !== -1) {\r\n      this.processResultDelta('reset', [result], []);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Adds a renderer.\r\n   * @param renderer The renderer.\r\n   */\r\n  public addRenderer(renderer: ValidationRenderer) {\r\n    this.renderers.push(renderer);\r\n    renderer.render({\r\n      kind: 'validate',\r\n      render: this.results.map(result => ({ result, elements: this.elements.get(result) as Element[] })),\r\n      unrender: []\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Removes a renderer.\r\n   * @param renderer The renderer.\r\n   */\r\n  public removeRenderer(renderer: ValidationRenderer) {\r\n    this.renderers.splice(this.renderers.indexOf(renderer), 1);\r\n    renderer.render({\r\n      kind: 'reset',\r\n      render: [],\r\n      unrender: this.results.map(result => ({ result, elements: this.elements.get(result) as Element[] }))\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Registers a binding with the controller.\r\n   * @param binding The binding instance.\r\n   * @param target The DOM element.\r\n   * @param rules (optional) rules associated with the binding. Validator implementation specific.\r\n   */\r\n  public registerBinding(binding: Binding, target: Element, rules?: any) {\r\n    this.bindings.set(binding, { target, rules, propertyInfo: null });\r\n  }\r\n\r\n  /**\r\n   * Unregisters a binding with the controller.\r\n   * @param binding The binding instance.\r\n   */\r\n  public unregisterBinding(binding: Binding) {\r\n    this.resetBinding(binding);\r\n    this.bindings.delete(binding);\r\n  }\r\n\r\n  /**\r\n   * Interprets the instruction and returns a predicate that will identify\r\n   * relevant results in the list of rendered validation results.\r\n   */\r\n  private getInstructionPredicate(instruction?: ValidateInstruction): (result: ValidateResult) => boolean {\r\n    if (instruction) {\r\n      const { object, propertyName, rules } = instruction;\r\n      let predicate: (result: ValidateResult) => boolean;\r\n      if (instruction.propertyName) {\r\n        predicate = x => x.object === object && x.propertyName === propertyName;\r\n      } else {\r\n        predicate = x => x.object === object;\r\n      }\r\n      if (rules) {\r\n        return x => predicate(x) && this.validator.ruleExists(rules, x.rule);\r\n      }\r\n      return predicate;\r\n    } else {\r\n      return () => true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates and renders results.\r\n   * @param instruction Optional. Instructions on what to validate. If undefined, all\r\n   * objects and bindings will be validated.\r\n   */\r\n  public validate(instruction?: ValidateInstruction): Promise<ControllerValidateResult> {\r\n    // Get a function that will process the validation instruction.\r\n    let execute: () => Promise<ValidateResult[]>;\r\n    if (instruction) {\r\n      // tslint:disable-next-line:prefer-const\r\n      let { object, propertyName, rules } = instruction;\r\n      // if rules were not specified, check the object map.\r\n      rules = rules || this.objects.get(object);\r\n      // property specified?\r\n      if (instruction.propertyName === undefined) {\r\n        // validate the specified object.\r\n        execute = () => this.validator.validateObject(object, rules);\r\n      } else {\r\n        // validate the specified property.\r\n        execute = () => this.validator.validateProperty(object, propertyName, rules);\r\n      }\r\n    } else {\r\n      // validate all objects and bindings.\r\n      execute = () => {\r\n        const promises: Promise<ValidateResult[]>[] = [];\r\n        for (const [object, rules] of Array.from(this.objects)) {\r\n          promises.push(this.validator.validateObject(object, rules));\r\n        }\r\n        for (const [binding, { rules }] of Array.from(this.bindings)) {\r\n          const propertyInfo = getPropertyInfo(binding.sourceExpression as Expression, binding.source);\r\n          if (!propertyInfo || this.objects.has(propertyInfo.object)) {\r\n            continue;\r\n          }\r\n          promises.push(this.validator.validateProperty(propertyInfo.object, propertyInfo.propertyName, rules));\r\n        }\r\n        return Promise.all(promises).then(resultSets => resultSets.reduce((a, b) => a.concat(b), []));\r\n      };\r\n    }\r\n\r\n    // Wait for any existing validation to finish, execute the instruction, render the results.\r\n    this.validating = true;\r\n    const returnPromise: Promise<ControllerValidateResult> = this.finishValidating\r\n      .then(execute)\r\n      .then((newResults: ValidateResult[]) => {\r\n        const predicate = this.getInstructionPredicate(instruction);\r\n        const oldResults = this.results.filter(predicate);\r\n        this.processResultDelta('validate', oldResults, newResults);\r\n        if (returnPromise === this.finishValidating) {\r\n          this.validating = false;\r\n        }\r\n        const result: ControllerValidateResult = {\r\n          instruction,\r\n          valid: newResults.find(x => !x.valid) === undefined,\r\n          results: newResults\r\n        };\r\n        this.invokeCallbacks(instruction, result);\r\n        return result;\r\n      })\r\n      .catch(exception => {\r\n        // recover, to enable subsequent calls to validate()\r\n        this.validating = false;\r\n        this.finishValidating = Promise.resolve();\r\n\r\n        return Promise.reject(exception);\r\n      });\r\n\r\n    this.finishValidating = returnPromise;\r\n\r\n    return returnPromise;\r\n  }\r\n\r\n  /**\r\n   * Resets any rendered validation results (unrenders).\r\n   * @param instruction Optional. Instructions on what to reset. If unspecified all rendered results\r\n   * will be unrendered.\r\n   */\r\n  public reset(instruction?: ValidateInstruction) {\r\n    const predicate = this.getInstructionPredicate(instruction);\r\n    const oldResults = this.results.filter(predicate);\r\n    this.processResultDelta('reset', oldResults, []);\r\n    this.invokeCallbacks(instruction, null);\r\n  }\r\n\r\n  /**\r\n   * Gets the elements associated with an object and propertyName (if any).\r\n   */\r\n  private getAssociatedElements({ object, propertyName }: ValidateResult): Element[] {\r\n    const elements: Element[] = [];\r\n    for (const [binding, { target }] of Array.from(this.bindings)) {\r\n      const propertyInfo = getPropertyInfo(binding.sourceExpression as Expression, binding.source);\r\n      if (propertyInfo && propertyInfo.object === object && propertyInfo.propertyName === propertyName) {\r\n        elements.push(target);\r\n      }\r\n    }\r\n    return elements;\r\n  }\r\n\r\n  private processResultDelta(\r\n    kind: 'validate' | 'reset',\r\n    oldResults: ValidateResult[], newResults: ValidateResult[]\r\n  ) {\r\n    // prepare the instruction.\r\n    const instruction: RenderInstruction = {\r\n      kind,\r\n      render: [],\r\n      unrender: []\r\n    };\r\n\r\n    // create a shallow copy of newResults so we can mutate it without causing side-effects.\r\n    newResults = newResults.slice(0);\r\n\r\n    // create unrender instructions from the old results.\r\n    for (const oldResult of oldResults) {\r\n      // get the elements associated with the old result.\r\n      const elements = this.elements.get(oldResult) as Element[];\r\n\r\n      // remove the old result from the element map.\r\n      this.elements.delete(oldResult);\r\n\r\n      // create the unrender instruction.\r\n      instruction.unrender.push({ result: oldResult, elements });\r\n\r\n      // determine if there's a corresponding new result for the old result we are unrendering.\r\n      const newResultIndex = newResults.findIndex(\r\n        x => x.rule === oldResult.rule && x.object === oldResult.object && x.propertyName === oldResult.propertyName);\r\n      if (newResultIndex === -1) {\r\n        // no corresponding new result... simple remove.\r\n        this.results.splice(this.results.indexOf(oldResult), 1);\r\n        if (!oldResult.valid) {\r\n          this.errors.splice(this.errors.indexOf(oldResult), 1);\r\n        }\r\n      } else {\r\n        // there is a corresponding new result...\r\n        const newResult = newResults.splice(newResultIndex, 1)[0];\r\n\r\n        // get the elements that are associated with the new result.\r\n        const elements = this.getAssociatedElements(newResult);\r\n        this.elements.set(newResult, elements);\r\n\r\n        // create a render instruction for the new result.\r\n        instruction.render.push({ result: newResult, elements });\r\n\r\n        // do an in-place replacement of the old result with the new result.\r\n        // this ensures any repeats bound to this.results will not thrash.\r\n        this.results.splice(this.results.indexOf(oldResult), 1, newResult);\r\n        if (!oldResult.valid && newResult.valid) {\r\n          this.errors.splice(this.errors.indexOf(oldResult), 1);\r\n        } else if (!oldResult.valid && !newResult.valid) {\r\n          this.errors.splice(this.errors.indexOf(oldResult), 1, newResult);\r\n        } else if (!newResult.valid) {\r\n          this.errors.push(newResult);\r\n        }\r\n      }\r\n    }\r\n\r\n    // create render instructions from the remaining new results.\r\n    for (const result of newResults) {\r\n      const elements = this.getAssociatedElements(result);\r\n      instruction.render.push({ result, elements });\r\n      this.elements.set(result, elements);\r\n      this.results.push(result);\r\n      if (!result.valid) {\r\n        this.errors.push(result);\r\n      }\r\n    }\r\n\r\n    // render.\r\n    for (const renderer of this.renderers) {\r\n      renderer.render(instruction);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates the property associated with a binding.\r\n   */\r\n  public validateBinding(binding: Binding) {\r\n    if (!binding.isBound) {\r\n      return;\r\n    }\r\n    const propertyInfo = getPropertyInfo(binding.sourceExpression as Expression, binding.source);\r\n    let rules;\r\n    const registeredBinding = this.bindings.get(binding);\r\n    if (registeredBinding) {\r\n      rules = registeredBinding.rules;\r\n      registeredBinding.propertyInfo = propertyInfo;\r\n    }\r\n    if (!propertyInfo) {\r\n      return;\r\n    }\r\n    const { object, propertyName } = propertyInfo;\r\n    this.validate({ object, propertyName, rules });\r\n  }\r\n\r\n  /**\r\n   * Resets the results for a property associated with a binding.\r\n   */\r\n  public resetBinding(binding: Binding) {\r\n    const registeredBinding = this.bindings.get(binding);\r\n    let propertyInfo = getPropertyInfo(binding.sourceExpression as Expression, binding.source);\r\n    if (!propertyInfo && registeredBinding) {\r\n      propertyInfo = registeredBinding.propertyInfo;\r\n    }\r\n    if (registeredBinding) {\r\n      registeredBinding.propertyInfo = null;\r\n    }\r\n    if (!propertyInfo) {\r\n      return;\r\n    }\r\n    const { object, propertyName } = propertyInfo;\r\n    this.reset({ object, propertyName });\r\n  }\r\n\r\n  /**\r\n   * Changes the controller's validateTrigger.\r\n   * @param newTrigger The new validateTrigger\r\n   */\r\n  public changeTrigger(newTrigger: validateTrigger) {\r\n    this.validateTrigger = newTrigger;\r\n    const bindings = Array.from(this.bindings.keys());\r\n    for (const binding of bindings) {\r\n      const source = binding.source;\r\n      binding.unbind();\r\n      binding.bind(source);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Revalidates the controller's current set of errors.\r\n   */\r\n  public revalidateErrors() {\r\n    for (const { object, propertyName, rule } of this.errors) {\r\n      if (rule.__manuallyAdded__) {\r\n        continue;\r\n      }\r\n      const rules = [[rule]];\r\n      this.validate({ object, propertyName, rules });\r\n    }\r\n  }\r\n\r\n  private invokeCallbacks(instruction: ValidateInstruction | undefined, result: ControllerValidateResult | null) {\r\n    if (this.eventCallbacks.length === 0) {\r\n      return;\r\n    }\r\n    const event = new ValidateEvent(\r\n      result ? 'validate' : 'reset',\r\n      this.errors,\r\n      this.results,\r\n      instruction || null,\r\n      result);\r\n    for (let i = 0; i < this.eventCallbacks.length; i++) {\r\n      this.eventCallbacks[i](event);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Information related to an \"& validate\" decorated binding.\r\n */\r\nexport interface BindingInfo {\r\n  /**\r\n   * The DOM element associated with the binding.\r\n   */\r\n  target: Element;\r\n\r\n  /**\r\n   * The rules associated with the binding via the validate binding behavior's rules parameter.\r\n   */\r\n  rules?: any;\r\n\r\n  /**\r\n   * The object and property associated with the binding.\r\n   */\r\n  propertyInfo: { object: any; propertyName: string; } | null;\r\n}\r\n","// tslint:disable:no-bitwise\r\nimport { Optional } from 'aurelia-dependency-injection';\r\nimport { TaskQueue } from 'aurelia-task-queue';\r\nimport { ValidationController } from './validation-controller';\r\nimport { validateTrigger } from './validate-trigger';\r\nimport { getTargetDOMElement } from './get-target-dom-element';\r\nimport { getPropertyInfo } from './property-info';\r\nimport { Expression } from 'aurelia-binding';\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property should be validated.\r\n */\r\nexport abstract class ValidateBindingBehaviorBase {\r\n  constructor(private taskQueue: TaskQueue) { }\r\n\r\n  protected abstract getValidateTrigger(controller: ValidationController): validateTrigger;\r\n\r\n  public bind(binding: any, source: any, rulesOrController?: ValidationController | any, rules?: any) {\r\n    // identify the target element.\r\n    const target = getTargetDOMElement(binding, source);\r\n\r\n    // locate the controller.\r\n    let controller: ValidationController;\r\n    if (rulesOrController instanceof ValidationController) {\r\n      controller = rulesOrController;\r\n    } else {\r\n      controller = source.container.get(Optional.of(ValidationController));\r\n      rules = rulesOrController;\r\n    }\r\n    if (controller === null) {\r\n      throw new Error(`A ValidationController has not been registered.`);\r\n    }\r\n\r\n    controller.registerBinding(binding, target, rules);\r\n    binding.validationController = controller;\r\n    const trigger = this.getValidateTrigger(controller);\r\n    const event =\r\n      (trigger & validateTrigger.blur) === validateTrigger.blur ? 'blur'\r\n        : (trigger & validateTrigger.focusout) === validateTrigger.focusout ? 'focusout'\r\n          : null;\r\n    const hasChangeTrigger = (trigger & validateTrigger.change) === validateTrigger.change;\r\n    binding.isDirty = !hasChangeTrigger;\r\n    // validatedOnce is used to control whether controller should validate upon user input\r\n    //\r\n    // always true when validation trigger doesn't include \"blur\" event (blur/focusout)\r\n    // else it will be set to true after (a) the first user input & loss of focus or (b) validation\r\n    binding.validatedOnce = hasChangeTrigger && event === null;\r\n    if (hasChangeTrigger) {\r\n      binding.vbbUpdateSource = binding.updateSource;\r\n      // tslint:disable-next-line:only-arrow-functions\r\n      // tslint:disable-next-line:space-before-function-paren\r\n      binding.updateSource = function (value: any) {\r\n        this.vbbUpdateSource(value);\r\n        this.isDirty = true;\r\n        if (this.validatedOnce) {\r\n          this.validationController.validateBinding(this);\r\n        }\r\n      };\r\n    }\r\n\r\n    if (event !== null) {\r\n      binding.focusLossHandler = () => {\r\n        this.taskQueue.queueMicroTask(() => {\r\n          if (binding.isDirty) {\r\n            controller.validateBinding(binding);\r\n            binding.validatedOnce = true;\r\n          }\r\n        });\r\n      };\r\n      binding.validationTriggerEvent = event;\r\n      binding.validateTarget = target;\r\n      target.addEventListener(event, binding.focusLossHandler);\r\n      if (hasChangeTrigger) {\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        const { propertyName } = getPropertyInfo(binding.sourceExpression as Expression, binding.source)!;\r\n        binding.validationSubscription = controller.subscribe((event) => {\r\n          if (!binding.validatedOnce && event.type === 'validate') {\r\n            binding.validatedOnce = event.errors.findIndex((e) => e.propertyName === propertyName) > -1;\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    if (trigger !== validateTrigger.manual) {\r\n      binding.standardUpdateTarget = binding.updateTarget;\r\n      // tslint:disable-next-line:only-arrow-functions\r\n      // tslint:disable-next-line:space-before-function-paren\r\n      binding.updateTarget = function (value: any) {\r\n        this.standardUpdateTarget(value);\r\n        this.validationController.resetBinding(this);\r\n      };\r\n    }\r\n  }\r\n\r\n  public unbind(binding: any) {\r\n    // reset the binding to it's original state.\r\n    if (binding.vbbUpdateSource) {\r\n      binding.updateSource = binding.vbbUpdateSource;\r\n      binding.vbbUpdateSource = null;\r\n    }\r\n    if (binding.standardUpdateTarget) {\r\n      binding.updateTarget = binding.standardUpdateTarget;\r\n      binding.standardUpdateTarget = null;\r\n    }\r\n    if (binding.focusLossHandler) {\r\n      binding.validateTarget.removeEventListener(binding.validationTriggerEvent, binding.focusLossHandler);\r\n      binding.focusLossHandler = null;\r\n      binding.validateTarget = null;\r\n    }\r\n    if (binding.validationSubscription) {\r\n      binding.validationSubscription.dispose();\r\n      binding.validationSubscription = null;\r\n    }\r\n    binding.validationController.unregisterBinding(binding);\r\n    binding.validationController = null;\r\n    binding.isDirty = null;\r\n    binding.validatedOnce = null;\r\n  }\r\n}\r\n","import { TaskQueue } from 'aurelia-task-queue';\r\nimport { ValidationController } from './validation-controller';\r\nimport { validateTrigger } from './validate-trigger';\r\nimport { ValidateBindingBehaviorBase } from './validate-binding-behavior-base';\r\nimport { bindingBehavior } from 'aurelia-binding';\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property should be validated\r\n * when the validate trigger specified by the associated controller's\r\n * validateTrigger property occurs.\r\n */\r\n@bindingBehavior('validate')\r\nexport class ValidateBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger(controller: ValidationController) {\r\n    return controller.validateTrigger;\r\n  }\r\n}\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property will be validated\r\n * manually, by calling controller.validate(). No automatic validation\r\n * triggered by data-entry or blur will occur.\r\n */\r\n@bindingBehavior('validateManually')\r\nexport class ValidateManuallyBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.manual;\r\n  }\r\n}\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property should be validated\r\n * when the associated element blurs.\r\n */\r\n@bindingBehavior('validateOnBlur')\r\nexport class ValidateOnBlurBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.blur;\r\n  }\r\n}\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property should be validated\r\n * when the associated element is changed by the user, causing a change\r\n * to the model.\r\n */\r\n@bindingBehavior('validateOnChange')\r\nexport class ValidateOnChangeBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.change;\r\n  }\r\n}\r\n\r\n/**\r\n * Binding behavior. Indicates the bound property should be validated\r\n * when the associated element blurs or is changed by the user, causing\r\n * a change to the model.\r\n */\r\n@bindingBehavior('validateOnChangeOrBlur')\r\nexport class ValidateOnChangeOrBlurBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.changeOrBlur;\r\n  }\r\n}\r\n\r\n@bindingBehavior('validateOnFocusout')\r\nexport class ValidateOnFocusoutBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.focusout;\r\n  }\r\n}\r\n\r\n@bindingBehavior('validateOnChangeOrFocusout')\r\nexport class ValidateOnChangeOrFocusoutBindingBehavior extends ValidateBindingBehaviorBase {\r\n  public static inject = [TaskQueue];\r\n\r\n  public getValidateTrigger() {\r\n    return validateTrigger.changeOrFocusout;\r\n  }\r\n}\r\n","import { Container } from 'aurelia-dependency-injection';\r\nimport { GlobalValidationConfiguration } from './config';\r\nimport { ValidationController } from './validation-controller';\r\nimport { Validator } from './validator';\r\nimport { PropertyAccessorParser } from './property-accessor-parser';\r\n\r\n/**\r\n * Creates ValidationController instances.\r\n */\r\nexport class ValidationControllerFactory {\r\n  public static get(container: Container) {\r\n    return new ValidationControllerFactory(container);\r\n  }\r\n\r\n  constructor(private container: Container) { }\r\n\r\n  /**\r\n   * Creates a new controller instance.\r\n   */\r\n  public create(validator?: Validator) {\r\n    if (!validator) {\r\n      validator = this.container.get(Validator) as Validator;\r\n    }\r\n    const propertyParser = this.container.get(PropertyAccessorParser) as PropertyAccessorParser;\r\n    const config = this.container.get(GlobalValidationConfiguration) as GlobalValidationConfiguration;\r\n    return new ValidationController(validator, propertyParser, config);\r\n  }\r\n\r\n  /**\r\n   * Creates a new controller and registers it in the current element's container so that it's\r\n   * available to the validate binding behavior and renderers.\r\n   */\r\n  public createForCurrentScope(validator?: Validator) {\r\n    const controller = this.create(validator);\r\n    this.container.registerInstance(ValidationController, controller);\r\n    return controller;\r\n  }\r\n}\r\n\r\n(ValidationControllerFactory as any)['protocol:aurelia:resolver'] = true;\r\n","import { bindingMode } from 'aurelia-binding';\r\nimport { Lazy } from 'aurelia-dependency-injection';\r\nimport { customAttribute, bindable } from 'aurelia-templating';\r\nimport { ValidationController } from './validation-controller';\r\nimport { ValidateResult } from './validate-result';\r\nimport { ValidationRenderer, RenderInstruction } from './validation-renderer';\r\nimport { DOM } from 'aurelia-pal';\r\n\r\nexport interface RenderedError {\r\n  error: ValidateResult;\r\n  targets: Element[];\r\n}\r\n\r\n@customAttribute('validation-errors')\r\nexport class ValidationErrorsCustomAttribute implements ValidationRenderer {\r\n\r\n  public static inject(): [typeof DOM.Element, Lazy<ValidationController>] {\r\n    return [DOM.Element, Lazy.of(ValidationController)];\r\n  }\r\n\r\n  @bindable({ defaultBindingMode: bindingMode.oneWay })\r\n  public controller: ValidationController | null = null;\r\n\r\n  @bindable({ primaryProperty: true, defaultBindingMode: bindingMode.twoWay })\r\n  public errors: RenderedError[] = [];\r\n\r\n  private errorsInternal: RenderedError[] = [];\r\n\r\n  constructor(private boundaryElement: Element, private controllerAccessor: () => ValidationController) {\r\n  }\r\n\r\n  public sort() {\r\n    this.errorsInternal.sort((a, b) => {\r\n      if (a.targets[0] === b.targets[0]) {\r\n        return 0;\r\n      }\r\n      // tslint:disable-next-line:no-bitwise\r\n      return a.targets[0].compareDocumentPosition(b.targets[0]) & 2 ? 1 : -1;\r\n    });\r\n  }\r\n\r\n  public interestingElements(elements: Element[]): Element[] {\r\n    return elements.filter(e => this.boundaryElement.contains(e));\r\n  }\r\n\r\n  public render(instruction: RenderInstruction) {\r\n    for (const { result } of instruction.unrender) {\r\n      const index = this.errorsInternal.findIndex(x => x.error === result);\r\n      if (index !== -1) {\r\n        this.errorsInternal.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    for (const { result, elements } of instruction.render) {\r\n      if (result.valid) {\r\n        continue;\r\n      }\r\n      const targets = this.interestingElements(elements);\r\n      if (targets.length) {\r\n        this.errorsInternal.push({ error: result, targets });\r\n      }\r\n    }\r\n\r\n    this.sort();\r\n    this.errors = this.errorsInternal;\r\n  }\r\n\r\n  public bind() {\r\n    if (!this.controller) {\r\n      this.controller = this.controllerAccessor();\r\n    }\r\n    // this will call render() with the side-effect of updating this.errors\r\n    this.controller.addRenderer(this);\r\n  }\r\n\r\n  public unbind() {\r\n    if (this.controller) {\r\n      this.controller.removeRenderer(this);\r\n    }\r\n  }\r\n}\r\n","import { ValidationController } from './validation-controller';\r\nimport { ValidationRenderer } from './validation-renderer';\r\nimport { customAttribute } from 'aurelia-templating';\r\n\r\n@customAttribute('validation-renderer')\r\nexport class ValidationRendererCustomAttribute {\r\n\r\n  private container: any;\r\n  private controller: ValidationController;\r\n  private value: string;\r\n  private renderer: ValidationRenderer;\r\n\r\n  public created(view: any) {\r\n    this.container = view.container;\r\n  }\r\n\r\n  public bind() {\r\n    this.controller = this.container.get(ValidationController);\r\n    this.renderer = this.container.get(this.value);\r\n    this.controller.addRenderer(this.renderer);\r\n  }\r\n\r\n  public unbind() {\r\n    this.controller.removeRenderer(this.renderer);\r\n    this.controller = null as any;\r\n    this.renderer = null as any;\r\n  }\r\n}\r\n","import { Rule, RuleProperty, ValidationDisplayNameAccessor } from './rule';\r\nimport { ValidationMessageParser } from './validation-message-parser';\r\nimport { Rules } from './rules';\r\nimport { validationMessages } from './validation-messages';\r\nimport { PropertyAccessorParser, PropertyAccessor } from '../property-accessor-parser';\r\nimport { isString } from '../util';\r\n\r\n/**\r\n * Part of the fluent rule API. Enables customizing property rules.\r\n */\r\nexport class FluentRuleCustomizer<TObject, TValue> {\r\n  private rule: Rule<TObject, TValue>;\r\n\r\n  constructor(\r\n    property: RuleProperty,\r\n    condition: (value: TValue, object?: TObject) => boolean | Promise<boolean>,\r\n    config: object = {},\r\n    private fluentEnsure: FluentEnsure<TObject>,\r\n    private fluentRules: FluentRules<TObject, TValue>,\r\n    private parsers: Parsers\r\n  ) {\r\n    this.rule = {\r\n      property,\r\n      condition,\r\n      config,\r\n      when: null,\r\n      messageKey: 'default',\r\n      message: null,\r\n      sequence: fluentRules.sequence\r\n    };\r\n    this.fluentEnsure._addRule(this.rule);\r\n  }\r\n\r\n  /**\r\n   * Validate subsequent rules after previously declared rules have\r\n   * been validated successfully. Use to postpone validation of costly\r\n   * rules until less expensive rules pass validation.\r\n   */\r\n  public then() {\r\n    this.fluentRules.sequence++;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Specifies the key to use when looking up the rule's validation message.\r\n   */\r\n  public withMessageKey(key: string) {\r\n    this.rule.messageKey = key;\r\n    this.rule.message = null;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Specifies rule's validation message.\r\n   */\r\n  public withMessage(message: string) {\r\n    this.rule.messageKey = 'custom';\r\n    this.rule.message = this.parsers.message.parse(message);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Specifies a condition that must be met before attempting to validate the rule.\r\n   * @param condition A function that accepts the object as a parameter and returns true\r\n   * or false whether the rule should be evaluated.\r\n   */\r\n  public when(condition: (object: TObject) => boolean) {\r\n    this.rule.when = condition;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Tags the rule instance, enabling the rule to be found easily\r\n   * using ValidationRules.taggedRules(rules, tag)\r\n   */\r\n  public tag(tag: string) {\r\n    this.rule.tag = tag;\r\n    return this;\r\n  }\r\n\r\n  ///// FluentEnsure APIs /////\r\n\r\n  /**\r\n   * Target a property with validation rules.\r\n   * @param property The property to target. Can be the property name or a property accessor function.\r\n   */\r\n  public ensure<TValue2>(subject: string | ((model: TObject) => TValue2)) {\r\n    return this.fluentEnsure.ensure<TValue2>(subject);\r\n  }\r\n\r\n  /**\r\n   * Targets an object with validation rules.\r\n   */\r\n  public ensureObject() {\r\n    return this.fluentEnsure.ensureObject();\r\n  }\r\n\r\n  /**\r\n   * Rules that have been defined using the fluent API.\r\n   */\r\n  public get rules() {\r\n    return this.fluentEnsure.rules;\r\n  }\r\n\r\n  /**\r\n   * Applies the rules to a class or object, making them discoverable by the StandardValidator.\r\n   * @param target A class or object.\r\n   */\r\n  public on(target: any) {\r\n    return this.fluentEnsure.on(target);\r\n  }\r\n\r\n  ///////// FluentRules APIs /////////\r\n\r\n  /**\r\n   * Applies an ad-hoc rule function to the ensured property or object.\r\n   * @param condition The function to validate the rule.\r\n   * Will be called with two arguments, the property value and the object.\r\n   * Should return a boolean or a Promise that resolves to a boolean.\r\n   */\r\n  public satisfies(condition: (value: TValue, object: TObject) => boolean | Promise<boolean>, config?: object) {\r\n    return this.fluentRules.satisfies(condition, config);\r\n  }\r\n\r\n  /**\r\n   * Applies a rule by name.\r\n   * @param name The name of the custom or standard rule.\r\n   * @param args The rule's arguments.\r\n   */\r\n  public satisfiesRule(name: string, ...args: any[]) {\r\n    return this.fluentRules.satisfiesRule(name, ...args);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"required\" rule to the property.\r\n   * The value cannot be null, undefined or whitespace.\r\n   */\r\n  public required() {\r\n    return this.fluentRules.required();\r\n  }\r\n\r\n  /**\r\n   * Applies the \"matches\" rule to the property.\r\n   * Value must match the specified regular expression.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public matches(regex: RegExp) {\r\n    return this.fluentRules.matches(regex);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"email\" rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public email() {\r\n    return this.fluentRules.email();\r\n  }\r\n\r\n  /**\r\n   * Applies the \"minLength\" STRING validation rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public minLength(length: number) {\r\n    return this.fluentRules.minLength(length);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"maxLength\" STRING validation rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public maxLength(length: number) {\r\n    return this.fluentRules.maxLength(length);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"minItems\" ARRAY validation rule to the property.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public minItems(count: number) {\r\n    return this.fluentRules.minItems(count);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"maxItems\" ARRAY validation rule to the property.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public maxItems(count: number) {\r\n    return this.fluentRules.maxItems(count);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"min\" NUMBER validation rule to the property.\r\n   * Value must be greater than or equal to the specified constraint.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public min(value: number) {\r\n    return this.fluentRules.min(value);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"max\" NUMBER validation rule to the property.\r\n   * Value must be less than or equal to the specified constraint.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public max(value: number) {\r\n    return this.fluentRules.max(value);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"range\" NUMBER validation rule to the property.\r\n   * Value must be between or equal to the specified min and max.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public range(min: number, max: number) {\r\n    return this.fluentRules.range(min, max);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"between\" NUMBER validation rule to the property.\r\n   * Value must be between but not equal to the specified min and max.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public between(min: number, max: number) {\r\n    return this.fluentRules.between(min, max);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"equals\" validation rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public equals(expectedValue: TValue) {\r\n    return this.fluentRules.equals(expectedValue);\r\n  }\r\n}\r\n\r\n/**\r\n * Part of the fluent rule API. Enables applying rules to properties and objects.\r\n */\r\nexport class FluentRules<TObject, TValue> {\r\n  public static customRules: {\r\n    [name: string]: {\r\n      condition: (value: any, object?: any, ...fluentArgs: any[]) => boolean | Promise<boolean>;\r\n      argsToConfig?: (...args: any[]) => any;\r\n    }\r\n  } = {};\r\n\r\n  /**\r\n   * Current rule sequence number. Used to postpone evaluation of rules until rules\r\n   * with lower sequence number have successfully validated. The \"then\" fluent API method\r\n   * manages this property, there's usually no need to set it directly.\r\n   */\r\n  public sequence = 0;\r\n\r\n  constructor(\r\n    private fluentEnsure: FluentEnsure<TObject>,\r\n    private parsers: Parsers,\r\n    private property: RuleProperty\r\n  ) { }\r\n\r\n  /**\r\n   * Sets the display name of the ensured property.\r\n   */\r\n  public displayName(name: string | ValidationDisplayNameAccessor | null) {\r\n    this.property.displayName = name;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Applies an ad-hoc rule function to the ensured property or object.\r\n   * @param condition The function to validate the rule.\r\n   * Will be called with two arguments, the property value and the object.\r\n   * Should return a boolean or a Promise that resolves to a boolean.\r\n   */\r\n  public satisfies(condition: (value: TValue, object?: TObject) => boolean | Promise<boolean>, config?: object) {\r\n    return new FluentRuleCustomizer<TObject, TValue>(\r\n      this.property, condition, config, this.fluentEnsure, this, this.parsers);\r\n  }\r\n\r\n  /**\r\n   * Applies a rule by name.\r\n   * @param name The name of the custom or standard rule.\r\n   * @param args The rule's arguments.\r\n   */\r\n  public satisfiesRule(name: string, ...args: any[]): FluentRuleCustomizer<TObject, TValue> {\r\n    let rule = FluentRules.customRules[name];\r\n    if (!rule) {\r\n      // standard rule?\r\n      rule = (this as any)[name];\r\n      if (rule instanceof Function) {\r\n        return rule.call(this, ...args);\r\n      }\r\n      throw new Error(`Rule with name \"${name}\" does not exist.`);\r\n    }\r\n    const config = rule.argsToConfig ? rule.argsToConfig(...args) : undefined;\r\n    return this.satisfies((value, obj) => rule.condition.call(this, value, obj, ...args), config)\r\n      .withMessageKey(name);\r\n  }\r\n\r\n  /**\r\n   * Applies the \"required\" rule to the property.\r\n   * The value cannot be null, undefined or whitespace.\r\n   */\r\n  public required() {\r\n    return this.satisfies(\r\n      value =>\r\n        value !== null\r\n        && value !== undefined\r\n        && !(isString(value) && !/\\S/.test(value as any))\r\n    ).withMessageKey('required');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"matches\" rule to the property.\r\n   * Value must match the specified regular expression.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public matches(regex: RegExp) {\r\n    return this.satisfies(\r\n      value => value === null || value === undefined || (value as any).length === 0 || regex.test(value as any))\r\n      .withMessageKey('matches');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"email\" rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public email() {\r\n    // regex from https://html.spec.whatwg.org/multipage/forms.html#valid-e-mail-address\r\n    /* tslint:disable:max-line-length */\r\n    return this.matches(/^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)\r\n      /* tslint:enable:max-line-length */\r\n      .withMessageKey('email');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"minLength\" STRING validation rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public minLength(length: number) {\r\n    return this.satisfies(\r\n      (value: any) => value === null || value === undefined || value.length === 0 || value.length >= length,\r\n      { length })\r\n      .withMessageKey('minLength');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"maxLength\" STRING validation rule to the property.\r\n   * null, undefined and empty-string values are considered valid.\r\n   */\r\n  public maxLength(length: number) {\r\n    return this.satisfies(\r\n      (value: any) => value === null || value === undefined || value.length === 0 || value.length <= length,\r\n      { length })\r\n      .withMessageKey('maxLength');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"minItems\" ARRAY validation rule to the property.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public minItems(count: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || value.length >= count, { count })\r\n      .withMessageKey('minItems');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"maxItems\" ARRAY validation rule to the property.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public maxItems(count: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || value.length <= count, { count })\r\n      .withMessageKey('maxItems');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"min\" NUMBER validation rule to the property.\r\n   * Value must be greater than or equal to the specified constraint.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public min(constraint: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || value >= constraint, { constraint })\r\n      .withMessageKey('min');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"max\" NUMBER validation rule to the property.\r\n   * Value must be less than or equal to the specified constraint.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public max(constraint: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || value <= constraint, { constraint })\r\n      .withMessageKey('max');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"range\" NUMBER validation rule to the property.\r\n   * Value must be between or equal to the specified min and max.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public range(min: number, max: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || (value >= min && value <= max),\r\n      { min, max })\r\n      .withMessageKey('range');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"between\" NUMBER validation rule to the property.\r\n   * Value must be between but not equal to the specified min and max.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public between(min: number, max: number) {\r\n    return this.satisfies((value: any) => value === null || value === undefined || (value > min && value < max),\r\n      { min, max })\r\n      .withMessageKey('between');\r\n  }\r\n\r\n  /**\r\n   * Applies the \"equals\" validation rule to the property.\r\n   * null and undefined values are considered valid.\r\n   */\r\n  public equals(expectedValue: TValue) {\r\n    return this.satisfies(\r\n      value => value === null || value === undefined || value as any === '' || value === expectedValue,\r\n      { expectedValue })\r\n      .withMessageKey('equals');\r\n  }\r\n}\r\n\r\n/**\r\n * Part of the fluent rule API. Enables targeting properties and objects with rules.\r\n */\r\nexport class FluentEnsure<TObject> {\r\n  /**\r\n   * Rules that have been defined using the fluent API.\r\n   */\r\n  public rules: Rule<TObject, any>[][] = [];\r\n\r\n  constructor(private parsers: Parsers) { }\r\n\r\n  /**\r\n   * Target a property with validation rules.\r\n   * @param property The property to target. Can be the property name or a property accessor\r\n   * function.\r\n   */\r\n  public ensure<TValue>(property: string | number | PropertyAccessor<TObject, TValue>): FluentRules<TObject, any> {\r\n    this.assertInitialized();\r\n    const name = this.parsers.property.parse(property);\r\n    const fluentRules = new FluentRules<TObject, TValue>(\r\n      this,\r\n      this.parsers,\r\n      { name, displayName: null });\r\n    return this.mergeRules(fluentRules, name);\r\n  }\r\n\r\n  /**\r\n   * Targets an object with validation rules.\r\n   */\r\n  public ensureObject(): FluentRules<TObject, any> {\r\n    this.assertInitialized();\r\n    const fluentRules = new FluentRules<TObject, TObject>(\r\n      this, this.parsers, { name: null, displayName: null });\r\n    return this.mergeRules(fluentRules, null);\r\n  }\r\n\r\n  /**\r\n   * Applies the rules to a class or object, making them discoverable by the StandardValidator.\r\n   * @param target A class or object.\r\n   */\r\n  public on(target: any) {\r\n    Rules.set(target, this.rules);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds a rule definition to the sequenced ruleset.\r\n   * @internal\r\n   */\r\n  public _addRule(rule: Rule<TObject, any>) {\r\n    while (this.rules.length < rule.sequence + 1) {\r\n      this.rules.push([]);\r\n    }\r\n    this.rules[rule.sequence].push(rule);\r\n  }\r\n\r\n  private assertInitialized() {\r\n    if (this.parsers) {\r\n      return;\r\n    }\r\n    throw new Error(`Did you forget to add \".plugin('aurelia-validation')\" to your main.js?`);\r\n  }\r\n\r\n  private mergeRules(fluentRules: FluentRules<TObject, any>, propertyName: string | number | null) {\r\n    // tslint:disable-next-line:triple-equals | Use loose equality for property keys\r\n    const existingRules = this.rules.find(r => r.length > 0 && r[0].property.name == propertyName);\r\n    if (existingRules) {\r\n      const rule = existingRules[existingRules.length - 1];\r\n      fluentRules.sequence = rule.sequence;\r\n      if (rule.property.displayName !== null) {\r\n        fluentRules = fluentRules.displayName(rule.property.displayName);\r\n      }\r\n    }\r\n    return fluentRules;\r\n  }\r\n}\r\n\r\n/**\r\n * Fluent rule definition API.\r\n */\r\nexport class ValidationRules {\r\n  private static parsers: Parsers;\r\n\r\n  public static initialize(messageParser: ValidationMessageParser, propertyParser: PropertyAccessorParser) {\r\n    this.parsers = {\r\n      message: messageParser,\r\n      property: propertyParser\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Target a property with validation rules.\r\n   * @param property The property to target. Can be the property name or a property accessor function.\r\n   */\r\n  public static ensure<TObject, TValue>(property: string | number | PropertyAccessor<TObject, TValue>) {\r\n    return new FluentEnsure<TObject>(ValidationRules.parsers).ensure(property);\r\n  }\r\n\r\n  /**\r\n   * Targets an object with validation rules.\r\n   */\r\n  public static ensureObject<TObject>() {\r\n    return new FluentEnsure<TObject>(ValidationRules.parsers).ensureObject();\r\n  }\r\n\r\n  /**\r\n   * Defines a custom rule.\r\n   * @param name The name of the custom rule. Also serves as the message key.\r\n   * @param condition The rule function.\r\n   * @param message The message expression\r\n   * @param argsToConfig A function that maps the rule's arguments to a \"config\"\r\n   * object that can be used when evaluating the message expression.\r\n   */\r\n  public static customRule(\r\n    name: string,\r\n    condition: (value: any, object?: any, ...args: any[]) => boolean | Promise<boolean>,\r\n    message: string,\r\n    argsToConfig?: (...args: any[]) => any\r\n  ) {\r\n    validationMessages[name] = message;\r\n    FluentRules.customRules[name] = { condition, argsToConfig };\r\n  }\r\n\r\n  /**\r\n   * Returns rules with the matching tag.\r\n   * @param rules The rules to search.\r\n   * @param tag The tag to search for.\r\n   */\r\n  public static taggedRules(rules: Rule<any, any>[][], tag: string): Rule<any, any>[][] {\r\n    return rules.map(x => x.filter(r => r.tag === tag));\r\n  }\r\n\r\n  /**\r\n   * Returns rules that have no tag.\r\n   * @param rules The rules to search.\r\n   */\r\n  public static untaggedRules(rules: Rule<any, any>[][]): Rule<any, any>[][] {\r\n    return rules.map(x => x.filter(r => r.tag === undefined));\r\n  }\r\n\r\n  /**\r\n   * Removes the rules from a class or object.\r\n   * @param target A class or object.\r\n   */\r\n  public static off(target: any): void {\r\n    Rules.unset(target);\r\n  }\r\n}\r\n\r\nexport interface Parsers {\r\n  message: ValidationMessageParser;\r\n  property: PropertyAccessorParser;\r\n}\r\n","// Exports\r\n\r\nexport * from './config';\r\nexport * from './controller-validate-result';\r\nexport * from './get-target-dom-element';\r\nexport * from './property-info';\r\nexport * from './property-accessor-parser';\r\nexport * from './validate-binding-behavior';\r\nexport * from './validate-event';\r\nexport * from './validate-instruction';\r\nexport * from './validate-result';\r\nexport * from './validate-trigger';\r\nexport * from './validation-controller';\r\nexport * from './validation-controller-factory';\r\nexport * from './validation-errors-custom-attribute';\r\nexport * from './validation-renderer-custom-attribute';\r\nexport * from './validation-renderer';\r\nexport * from './validator';\r\n\r\nexport * from './implementation/rule';\r\nexport * from './implementation/rules';\r\nexport * from './implementation/standard-validator';\r\nexport * from './implementation/validation-messages';\r\nexport * from './implementation/validation-message-parser';\r\nexport * from './implementation/validation-rules';\r\n\r\n// Configuration\r\n\r\nimport { Container } from 'aurelia-dependency-injection';\r\nimport { GlobalValidationConfiguration } from './config';\r\nimport { ValidationMessageParser } from './implementation/validation-message-parser';\r\nimport { PropertyAccessorParser } from './property-accessor-parser';\r\nimport { ValidationRules } from './implementation/validation-rules';\r\nimport {\r\n  ValidateBindingBehavior,\r\n  ValidateManuallyBindingBehavior,\r\n  ValidateOnBlurBindingBehavior,\r\n  ValidateOnChangeBindingBehavior,\r\n  ValidateOnChangeOrBlurBindingBehavior,\r\n  ValidateOnFocusoutBindingBehavior,\r\n  ValidateOnChangeOrFocusoutBindingBehavior\r\n} from './validate-binding-behavior';\r\nimport { ValidationErrorsCustomAttribute } from './validation-errors-custom-attribute';\r\nimport { ValidationRendererCustomAttribute } from './validation-renderer-custom-attribute';\r\n\r\n/**\r\n * Configures the plugin.\r\n */\r\nexport function configure(\r\n  // tslint:disable-next-line:ban-types\r\n  frameworkConfig: { container: Container, globalResources?: (...resources: any[]) => any },\r\n  callback?: (config: GlobalValidationConfiguration) => void\r\n) {\r\n  // the fluent rule definition API needs the parser to translate messages\r\n  // to interpolation expressions.\r\n  const messageParser = frameworkConfig.container.get(ValidationMessageParser);\r\n  const propertyParser = frameworkConfig.container.get(PropertyAccessorParser);\r\n  ValidationRules.initialize(messageParser, propertyParser);\r\n\r\n  // configure...\r\n  const config = new GlobalValidationConfiguration();\r\n  if (callback instanceof Function) {\r\n    callback(config);\r\n  }\r\n  config.apply(frameworkConfig.container);\r\n\r\n  // globalize the behaviors.\r\n  if (frameworkConfig.globalResources) {\r\n    frameworkConfig.globalResources(\r\n      ValidateBindingBehavior,\r\n      ValidateManuallyBindingBehavior,\r\n      ValidateOnBlurBindingBehavior,\r\n      ValidateOnFocusoutBindingBehavior,\r\n      ValidateOnChangeBindingBehavior,\r\n      ValidateOnChangeOrBlurBindingBehavior,\r\n      ValidateOnChangeOrFocusoutBindingBehavior,\r\n      ValidationErrorsCustomAttribute,\r\n      ValidationRendererCustomAttribute);\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}